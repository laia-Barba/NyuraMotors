<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Nyura Motors - Registro</title>
    <link rel="stylesheet" href="EstiloPrincipal.css">
    <link rel="stylesheet" href="auth.css">
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;800&family=Poppins:wght@500;700;800&display=swap" rel="stylesheet">
    <style>
        main { margin-top: 0; }
        #submitBtn:disabled {
            opacity: 0.5;
            cursor: not-allowed;
        }
    </style>
</head>
<body>
    <main>
        <section class="auth-page">
            <div class="auth-card" style="max-width: 560px; grid-template-columns: 1fr;">
                <div class="auth-content" style="background: transparent;">
                    <div class="auth-row" style="justify-content: flex-start; margin-bottom: 0.5rem;">
                        <a class="auth-link" href="home.html" style="display: inline-flex; align-items: center; gap: 0.5rem;">
                            <span aria-hidden="true">←</span>
                            <span>Volver</span>
                        </a>
                    </div>

                    <p class="auth-kicker">Nyura Motors</p>
                    <h1 class="auth-title" style="font-size: 1.85rem;">Crear cuenta</h1>

                    <form class="auth-form" action="#" method="post" novalidate id="registroForm">
                        <label>
                            <span>Nombre</span>
                            <input class="auth-input" type="text" name="nombre" autocomplete="given-name" placeholder="Tu nombre" required>
                        </label>

                        <label>
                            <span>Email</span>
                            <input class="auth-input" type="email" name="email" autocomplete="email" placeholder="nombre@correo.com" required>
                        </label>

                        <label>
                            <span>Teléfono</span>
                            <input class="auth-input" type="tel" name="telefono" autocomplete="tel" placeholder="+34 600 000 000">
                        </label>

                        <label>
                            <span>Contraseña</span>
                            <input class="auth-input" type="password" name="contrasena" autocomplete="new-password" placeholder="Mínimo 8 caracteres" required>
                        </label>

                        <label>
                            <span>Repetir contraseña</span>
                            <input class="auth-input" type="password" name="contrasena_repeat" autocomplete="new-password" placeholder="Repite tu contraseña" required>
                        </label>

                        <label class="auth-check" style="align-items: flex-start;">
                            <p> 
                                <input type="checkbox" name="terms" id="termsCheckbox" required />
                                <span>Acepto la política de privacidad y las condiciones de uso</span>
                            </p>
                            
                        </label>

                        <button class="auth-submit" type="submit" id="submitBtn" disabled>Crear cuenta</button>

                        <p class="auth-alt">¿Ya tienes cuenta? <a class="auth-link" href="InicioSesion.html">Inicia sesión</a></p>
                    </form>
                </div>
            </div>
        </section>
    </main>
    <script>
        document.addEventListener('DOMContentLoaded', function() {
            const termsCheckbox = document.getElementById('termsCheckbox');
            const submitBtn = document.getElementById('submitBtn');
            const form = document.getElementById('registroForm');
            const passwordInput = document.querySelector('input[name="contrasena"]');
            const passwordRepeatInput = document.querySelector('input[name="contrasena_repeat"]');

            // Control del checkbox de términos
            termsCheckbox.addEventListener('change', function() {
                submitBtn.disabled = !this.checked;
            });

            // Validación de contraseñas en tiempo real
            function validatePasswords() {
                const password = passwordInput.value;
                const repeatPassword = passwordRepeatInput.value;
                
                // Validar fortaleza de contraseña
                const hasMinLength = password.length >= 8;
                const hasUpperCase = /[A-Z]/.test(password);
                const hasLowerCase = /[a-z]/.test(password);
                const hasNumbers = /\d/.test(password);
                
                let errorMessage = '';
                if (!hasMinLength) errorMessage = 'La contraseña debe tener al menos 8 caracteres';
                else if (!hasUpperCase) errorMessage = 'La contraseña debe tener al menos una mayúscula';
                else if (!hasLowerCase) errorMessage = 'La contraseña debe tener al menos una minúscula';
                else if (!hasNumbers) errorMessage = 'La contraseña debe tener al menos un número';
                
                // Validar que las contraseñas coincidan
                if (repeatPassword && password !== repeatPassword) {
                    errorMessage = errorMessage ? `${errorMessage} y las contraseñas no coinciden` : 'Las contraseñas no coinciden';
                }
                
                return { isValid: !errorMessage, message: errorMessage };
            }

            // Mostrar errores de contraseña
            function showPasswordError(message) {
                // Eliminar mensaje de error anterior si existe
                const existingError = passwordRepeatInput.parentNode.querySelector('.password-error');
                if (existingError) existingError.remove();
                
                if (message) {
                    const errorDiv = document.createElement('div');
                    errorDiv.className = 'password-error';
                    errorDiv.style.cssText = 'color: #e74c3c; font-size: 0.85rem; margin-top: 0.25rem;';
                    errorDiv.textContent = message;
                    passwordRepeatInput.parentNode.appendChild(errorDiv);
                }
            }

            // Validar mientras escribe
            passwordInput.addEventListener('input', function() {
                const validation = validatePasswords();
                showPasswordError(validation.message);
            });

            passwordRepeatInput.addEventListener('input', function() {
                const validation = validatePasswords();
                showPasswordError(validation.message);
            });

            // Validación completa del formulario
            form.addEventListener('submit', function(e) {
                e.preventDefault();
                
                // Limpiar errores anteriores
                document.querySelectorAll('.field-error').forEach(el => el.remove());
                
                let hasErrors = false;
                
                // Validar campos obligatorios
                const requiredFields = ['nombre', 'email'];
                requiredFields.forEach(fieldName => {
                    const field = form.querySelector(`[name="${fieldName}"]`);
                    if (!field.value.trim()) {
                        const errorDiv = document.createElement('div');
                        errorDiv.className = 'field-error';
                        errorDiv.style.cssText = 'color: #e74c3c; font-size: 0.85rem; margin-top: 0.25rem;';
                        errorDiv.textContent = 'Este campo es obligatorio';
                        field.parentNode.appendChild(errorDiv);
                        hasErrors = true;
                    }
                });
                
                // Validar email
                const emailInput = form.querySelector('[name="email"]');
                const emailRegex = /^[^\s@]+@[^\s@]+\.[^\s@]+$/;
                if (emailInput.value && !emailRegex.test(emailInput.value)) {
                    const errorDiv = document.createElement('div');
                    errorDiv.className = 'field-error';
                    errorDiv.style.cssText = 'color: #e74c3c; font-size: 0.85rem; margin-top: 0.25rem;';
                    errorDiv.textContent = 'El email no es válido';
                    emailInput.parentNode.appendChild(errorDiv);
                    hasErrors = true;
                }
                
                // Validar teléfono si se proporciona
                const phoneInput = form.querySelector('[name="telefono"]');
                if (phoneInput.value) {
                    const phoneRegex = /^\+?\d{9,15}$/;
                    if (!phoneRegex.test(phoneInput.value.replace(/\s/g, ''))) {
                        const errorDiv = document.createElement('div');
                        errorDiv.className = 'field-error';
                        errorDiv.style.cssText = 'color: #e74c3c; font-size: 0.85rem; margin-top: 0.25rem;';
                        errorDiv.textContent = 'El teléfono debe tener entre 9 y 15 dígitos';
                        phoneInput.parentNode.appendChild(errorDiv);
                        hasErrors = true;
                    }
                }
                
                // Validar contraseña
                const passwordValidation = validatePasswords();
                if (!passwordValidation.isValid) {
                    showPasswordError(passwordValidation.message);
                    hasErrors = true;
                }
                
                // Validar términos
                if (!termsCheckbox.checked) {
                    alert('Debes aceptar los términos y condiciones para registrarte');
                    hasErrors = true;
                }
                
                // Si no hay errores, enviar formulario
                if (!hasErrors) {
                    // Aquí iría la lógica de envío al servidor
                    alert('Registro completado correctamente');
                    // form.submit(); // Descomentar para enviar realmente
                }
            });
        });
    </script>
</body>
</html>
