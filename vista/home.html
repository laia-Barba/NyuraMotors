<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Nyura Motors - El Futur de la Mobilitat</title>
    <link rel="stylesheet" href="EstiloPrincipal.css">
    <link rel="stylesheet" href="home.css">
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;800&family=Poppins:wght@500;700;800&display=swap" rel="stylesheet">
</head>
<body>
    <header>
        <nav>
            <!-- Logo como imagen -->
            <a href="home.html"><img src="../Imagenes/NYURAlogopagina.png" alt="Nyura Motors" class="logo-img"></a>
            
            <ul>
                <li><a href="home.html">Inicio</a></li>
                <li><a href="Gama.html">Modelos</a></li>
                <li><a href="Configurador3D.html">Configurador 3D</a></li>
                <li><a href="contacto.html">Contacto</a></li>
                <li id="authMenu"><a href="InicioSesion.html"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" aria-hidden="true" style="width: 16px; height: 16px; vertical-align: -2px; margin-right: 6px;"><path d="M12 12a4 4 0 1 0-4-4 4 4 0 0 0 4 4Zm0 2c-4.41 0-8 2-8 4.5V21h16v-2.5c0-2.5-3.59-4.5-8-4.5Z"/></svg>Iniciar sesi√≥n</a></li>
            </ul>
        </nav>
    </header>

    <main>
        <!-- Carrusel -->
        <section class="carousel-section">
            <div class="carousel-container">
                <button class="carousel-btn carousel-btn-left" onclick="moveCarousel(-1)" aria-label="Anterior">
                    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" width="24" height="24">
                        <path d="M15.41 7.41L14 6l-6 6 6 6 1.41-1.41L10.83 12z"/>
                    </svg>
                </button>
                
                <div class="carousel-track">
                    <div class="carousel-slide active">
                        <img src="../Imagenes/paginaInicio/Carrusel3.png" alt="Nyura Motors - Imagen 1">
                        <div class="carousel-caption">
                            <h2>Nuevo Nyura Nova Sport</h2>
                            <p>Conoce la emocion de la deportividad con nuestro Nova Nova Sport desde 29.490‚Ç¨</p>
                        </div>
                    </div>
                    <div class="carousel-slide">
                        <img src="../Imagenes/paginaInicio/Carrusel1.png" alt="Nyura Motors - Imagen 2">
                    </div>
                </div>
                
                <button class="carousel-btn carousel-btn-right" onclick="moveCarousel(1)" aria-label="Siguiente">
                    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" width="24" height="24">
                        <path d="M10 6L8.59 7.41 13.17 12l-4.58 4.59L10 18l6-6z"/>
                    </svg>
                </button>
            </div>
            
            <!-- Indicadores -->
            <div class="carousel-indicators">
                <button class="indicator active" onclick="goToSlide(0)" aria-label="Ir a slide 1"></button>
                <button class="indicator" onclick="goToSlide(1)" aria-label="Ir a slide 2"></button>
            </div>
        </section>
        
        <!-- Secci√≥n Introducci√≥n Modelos -->
        <section class="intro-section">
            <div class="intro-container">
                <h2 class="intro-title">Conoce Nuestros Modelos</h2>
                <p class="intro-text">
                    Descubre la gama completa de veh√≠culos Nyura Motors, dise√±ados para ofrecer el m√°ximo rendimiento, 
                    eficiencia y estilo. Desde berlinas familiares hasta deportivos de alto rendimiento, 
                    cada modelo representa la excelencia en ingenier√≠a automotriz.
                </p>
                <div class="intro-features">
                    <div class="feature-item">
                        <div class="feature-icon-wrapper">
                            <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                                <path d="M13 2L3 14h9l9-11v11H3z"/>
                                <polyline points="13 2 3 14 3 14 8"/>
                            </svg>
                        </div>
                        <span class="feature-text">Dise√±o Vanguardista</span>
                    </div>
                    <div class="feature-item">
                        <div class="feature-icon-wrapper">
                            <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                                <polygon points="13 2 3 14 2 14 15 13 15 13 2"/>
                                <path d="M13 15v6a3 3 0 0 0 6 0v-6"/>
                            </svg>
                        </div>
                        <span class="feature-text">Rendimiento Superior</span>
                    </div>
                    <div class="feature-item">
                        <div class="feature-icon-wrapper">
                            <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                                <path d="M22 12h-4l-3 9L9 12l6-9"/>
                                <path d="M5.12 2.84a4 4 0 0 1 0 7.17L9 12l4.88-4.99a4 4 0 0 1 0-7.17z"/>
                            </svg>
                        </div>
                        <span class="feature-text">Tecnolog√≠a Punta</span>
                    </div>
                </div>
            </div>
        </section>
        
        <!-- Secci√≥n de Modelos -->
        <section class="modelos-section">
            <div class="modelos-container">
                <h1 class="modelos-title">Modelos</h1>
                <div class="modelos-grid">
                    <!-- Aqu√≠ se a√±adir√°n las tarjetas de los modelos futuros -->
                    <div class="modelo-card">
                        <div class="modelo-image">
                            <img src="../Imagenes/Imagenesmodelos/modelo1.png" alt="Modelo Nyura">
                            <div class="fuel-badge hibrido">
                                <span class="fuel-text">Hibrido</span>
                            </div>
                        </div>
                        <div class="modelo-info">
                            <h3>Nova</h3>
                            <p>La berlina ideal para familias</p>
                        </div>
                    </div>
                    <div class="modelo-card">
                        <div class="modelo-image">
                            <img src="../Imagenes/Imagenesmodelos/modelo2.png" alt="Modelo Nyura">
                            <div class="fuel-badge gasolina">
                                <span class="fuel-text">Gasolina</span>
                            </div>
                        </div>
                        <div class="modelo-info">
                            <h3>Nova Sport</h3>
                            <p>La berlina deportiva ideal para pilotos</p>
                        </div>
                    </div>
                    <div class="modelo-card">
                        <div class="modelo-image">
                            <img src="../Imagenes/Imagenesmodelos/modelo3.png" alt="Modelo Nyura">
                            <div class="fuel-badge electrico">
                                <span class="fuel-text">Electrico</span>
                            </div>
                        </div>
                        <div class="modelo-info">
                            <h3>Altamira</h3>
                            <p>La berlina ideal para familias</p>
                        </div>
                    </div>
                </div>
            </div>
        </section>
    </main>

    <footer>
    <div class="footer-content">
        <!-- Nyura Motors -->
        <div class="footer-section">
            <img src="../Imagenes/LogoBlancoNyura.png" alt="Nyura Motors" class="logo-img" style="height: 143px; opacity: 0.9;">
            <p>El futur de la mobilitat el√®ctrica. Disseny innovador, rendiment superior i tecnologia punta.</p>
        </div>

        <!-- Enlla√ßos principals -->
        <div class="footer-section">
            <h3>Paginas de Nyura Motors</h3>
            <div class="footer-links">
                <a href="home.html">Home</a>
                <a href="Gama.html">Modelos</a>
                <a href="Configurador3D.html">Configurador 3D</a>
                <a href="contacto.html">Contacto</a>
            </div>
        </div>

        

        <!-- Contacte & Xarxes -->
        <div class="footer-section">
            <h3>Contacte</h3>
            <p>üìß contacto@nyuramotors.com<br>
               üì± +34 612 345 678<br>
               üìç Carrer de Caracas, 11. Sant Andreu, 08030 Barcelona</p>
            <div class="social-links">
                <a href="#" aria-label="Twitter">ùïè</a>
                <a href="#" aria-label="Instagram">üì∑</a>
                <a href="#" aria-label="YouTube">üì∫</a>
                <a href="#" aria-label="LinkedIn">üíº</a>
            </div>
        </div>
    </div>
    
    <div class="footer-bottom">
        <p>&copy; 2026 Nyura Motors. Tots els drets reservats. | 
           <a href="#" style="color: #4A6FFF;">Pol√≠tica de Privacitat</a> | 
           <a href="#" style="color: #4A6FFF;">Condicions d'√∫s</a> | 
           <a href="#" style="color: #4A6FFF;">Cookies</a>
        </p>
    </div>
</footer>

<script type="module">
        import { getCurrentUser, createOrUpdateUserProfile, onAuthStateChange, signOut } from '../controlador/BBDD/SupabaseCliente.js';
        
        document.addEventListener('DOMContentLoaded', async function() {
            const authMenu = document.getElementById('authMenu');
            
            // Funci√≥n para actualizar el men√∫ de autenticaci√≥n
            function updateAuthMenu(user) {
                if (user) {
                    const displayName = user.user_metadata?.nombre || user.email.split('@')[0];
                    authMenu.innerHTML = `
                        <div class="auth-dropdown">
                            <button class="auth-dropdown-toggle" onclick="toggleAuthMenu()">
                                <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" aria-hidden="true" style="width: 16px; height: 16px; vertical-align: -2px; margin-right: 6px;">
                                    <path d="M12 12a4 4 0 1 0-4-4 4 4 0 0 0 4 4Zm0 2c-4.41 0-8 2-8 4.5V21h16v-2.5c0-2.5-3.59-4.5-8-4.5Z"/>
                                </svg>
                                ${displayName}
                                <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" aria-hidden="true" style="width: 12px; height: 12px; margin-left: 4px;">
                                    <path d="M7 10l5 5 5-5z"/>
                                </svg>
                            </button>
                            <div class="auth-dropdown-menu" id="authDropdownMenu">
                                <a href="#" onclick="viewProfile()">
                                    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" aria-hidden="true" style="width: 16px; height: 16px; margin-right: 8px;">
                                        <path d="M12 12a4 4 0 1 0-4-4 4 4 0 0 0 4 4Zm0 2c-4.41 0-8 2-8 4.5V21h16v-2.5c0-2.5-3.59-4.5-8-4.5Z"/>
                                    </svg>
                                    Ver perfil
                                </a>
                                <a href="#" onclick="handleSignOut()" style="color: #dc3545;">
                                    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" aria-hidden="true" style="width: 16px; height: 16px; margin-right: 8px;">
                                        <path d="M17 7l-1.41 1.41L18.17 11H8v2h10.17l-2.58 2.58L17 17l5-5-5-5zM4 5h8V3H4c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h8v-2H4V5z"/>
                                    </svg>
                                    Cerrar sesi√≥n
                                </a>
                            </div>
                        </div>
                    `;
                } else {
                    authMenu.innerHTML = `
                        <a href="InicioSesion.html">
                            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" aria-hidden="true" style="width: 16px; height: 16px; vertical-align: -2px; margin-right: 6px;">
                                <path d="M12 12a4 4 0 1 0-4-4 4 4 0 0 0 4 4Zm0 2c-4.41 0-8 2-8 4.5V21h16v-2.5c0-2.5-3.59-4.5-8-4.5Z"/>
                            </svg>
                            Iniciar sesi√≥n
                        </a>
                    `;
                }
            }
            
            // Funci√≥n para toggle del men√∫ desplegable
            window.toggleAuthMenu = function() {
                const menu = document.getElementById('authDropdownMenu');
                menu.style.display = menu.style.display === 'block' ? 'none' : 'block';
            };
            
            // Funci√≥n para ver perfil
            window.viewProfile = function() {
                const currentUser = getCurrentUser();
                if (currentUser) {
                    const displayName = currentUser.user_metadata?.nombre || currentUser.email.split('@')[0];
                    alert(`Perfil de ${displayName}\n\nEmail: ${currentUser.email}\nTel√©fono: ${currentUser.user_metadata?.telefono || 'No especificado'}`);
                }
                toggleAuthMenu(); // Cerrar el men√∫
            };
            
            // Funci√≥n para cerrar sesi√≥n
            window.handleSignOut = async function() {
                try {
                    const result = await signOut();
                    if (result.success) {
                        console.log('Sesi√≥n cerrada correctamente');
                        updateAuthMenu(null);
                        // Opcional: redirigir a p√°gina de login
                        // window.location.href = 'InicioSesion.html';
                    } else {
                        console.error('Error al cerrar sesi√≥n:', result.error);
                        alert('Error al cerrar sesi√≥n. Intenta de nuevo.');
                    }
                } catch (error) {
                    console.error('Error inesperado al cerrar sesi√≥n:', error);
                    alert('Error inesperado. Intenta de nuevo.');
                }
            };
            
            // Cerrar men√∫ al hacer clic fuera
            document.addEventListener('click', function(event) {
                const dropdown = document.querySelector('.auth-dropdown');
                if (dropdown && !dropdown.contains(event.target)) {
                    const menu = document.getElementById('authDropdownMenu');
                    if (menu) {
                        menu.style.display = 'none';
                    }
                }
            });
            
            // Verificar estado inicial
            const currentUser = await getCurrentUser();
            updateAuthMenu(currentUser);
            
            // Escuchar cambios en autenticaci√≥n
            onAuthStateChange(async (event, session) => {
                if (event === 'SIGNED_IN' && session?.user) {
                    console.log('Usuario autenticado:', session.user);
                    
                    // Crear o actualizar perfil en tabla users
                    const profileResult = await createOrUpdateUserProfile(session.user);
                    
                    if (profileResult.success) {
                        console.log('Perfil procesado:', profileResult.action);
                        if (profileResult.action === 'created') {
                            console.log('Nuevo perfil creado para usuario de Google');
                        }
                    } else {
                        console.error('Error procesando perfil:', profileResult.error);
                    }
                    
                    updateAuthMenu(session.user);
                } else if (event === 'SIGNED_OUT') {
                    console.log('Usuario cerr√≥ sesi√≥n');
                    updateAuthMenu(null);
                }
            });
        });
    </script>

    <!-- Script del carrusel -->
    <script>
        let currentSlide = 0;
        const totalSlides = 2;

        function moveCarousel(direction) {
            console.log('moveCarousel called with direction:', direction);
            currentSlide += direction;
            
            // Ciclo infinito
            if (currentSlide < 0) {
                currentSlide = totalSlides - 1;
            } else if (currentSlide >= totalSlides) {
                currentSlide = 0;
            }
            
            console.log('New currentSlide:', currentSlide);
            updateCarousel();
        }

        function goToSlide(slideIndex) {
            currentSlide = slideIndex;
            updateCarousel();
        }

        function updateCarousel() {
            const track = document.querySelector('.carousel-track');
            const slides = document.querySelectorAll('.carousel-slide');
            const indicators = document.querySelectorAll('.indicator');
            
            // Mover el track
            track.style.transform = `translateX(-${currentSlide * 50}%)`;
            
            // Actualizar clases active
            slides.forEach((slide, index) => {
                slide.classList.toggle('active', index === currentSlide);
            });
            
            indicators.forEach((indicator, index) => {
                indicator.classList.toggle('active', index === currentSlide);
            });
        }

        // Auto-avance opcional (cada 2 segundos)
        let autoPlayInterval;
        
        function startAutoPlay() {
            console.log('Starting autoplay with 2 second interval');
            autoPlayInterval = setInterval(() => {
                console.log('Autoplay tick - moving carousel');
                moveCarousel(1);
            }, 2000); // Cambiado a 2 segundos
        }
        
        function stopAutoPlay() {
            clearInterval(autoPlayInterval);
        }

        // Pausar auto-play cuando el usuario interact√∫a
        document.addEventListener('DOMContentLoaded', function() {
            const container = document.querySelector('.carousel-container');
            
            container.addEventListener('mouseenter', stopAutoPlay);
            container.addEventListener('mouseleave', startAutoPlay);
        });
        
        // Iniciar auto-play inmediatamente
        startAutoPlay();
    </script>
</body>
</html>
